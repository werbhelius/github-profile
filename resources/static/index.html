<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>GitHub Profile Summary</title>
    <link rel="stylesheet" href="../static/css/style.css">
    <link rel="stylesheet" href="../static/css/loaders.min.css">
</head>
<body>
<div style="height: 100%">
    <div id="index-page">
        <p class="index-title">GitHub Profile <span class="index-title-span">Summary</span></p>
        <div id="userNameDiv" class="index-input-div">
            <input id='userNameInput' class="index-input" spellcheck="false" placeholder="Input your GitHub Username Like 'werbhelius'" type="text" autocomplete="on"
                   onkeypress="checkName(event, this)"/>
        </div>
        <p class="index-find-me">Find me on&nbsp;&nbsp;&nbsp;
            <a target="_blank" href="http://github.com/werbhelius"><img src="../static/css/svg/github.svg"></a> ,&nbsp;&nbsp;&nbsp;
            <a target="_blank" href="https://twitter.com/WerbHelius"><img src="../static/css/svg/twitter.svg"></a> ,&nbsp;&nbsp;&nbsp;
            <a target="_blank" href="https://weibo.com/singerwannber"><img src="../static/css/svg/weibo.svg"></a> ,&nbsp;&nbsp;&nbsp;
            <a target="_blank" href="https://www.instagram.com/i.am.werb/"><img
                    src="../static/css/svg/ins.svg"></a>&nbsp;&nbsp;<span class="index-title-span">and</span>&nbsp;&nbsp;
            <a target="_blank" href="mailto:werbhelius@gmail.com"><img src="../static/css/svg/email.svg"></a> .</p>
        <div id="loading" class="loading" style="display: none">
            <div class="line-scale-pulse-out">
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
            </div>
        </div>
    </div>
    <div id="error-page"></div>
    <footer class="index-footer">
        <p class="index-footer-title">Licensed under the <a target="_blank"
                                                            href="https://github.com/werbhelius/github-profile"><span
                class="index-title-span">Apache 2 license</span></a></p>
        <p class="index-footer-title">Design & Develop <img src="../static/css/svg/heart.svg"> by <a target="_blank"
                                                                                                  href="https://about.me/werbhelius"><span
                class="index-title-span">werbhelius</span></a></p>
        <p class="index-footer-title">Source is on <a target="_blank"
                                                      href="https://github.com/werbhelius/github-profile"><span
                class="index-title-span">Github</span></a></p>
    </footer>
</div>
<script>
    function checkName(e, input) {
        if (e.code !== "Enter") return;
        if (input.value === "") {
            input.classList.add("shake");
            setTimeout(function () {
                input.classList.remove("shake");
            }, 500);
        } else {
            requestName(input)
        }
    }

    function requestName(input) {
        input.disabled = "disabled";
        document.getElementById("loading").style.display = "block";
        var name = input.value;
        var ajaxObj = new XMLHttpRequest();
        ajaxObj.open('get', '/api/user?username=' + name);
        ajaxObj.setRequestHeader("client", "web");
        ajaxObj.send();
        ajaxObj.onreadystatechange = function () {
            if (ajaxObj.readyState !== 4) return ;
            document.getElementById("loading").style.display = "none";
            input.disabled = "";
            if (ajaxObj.status >= 200 && ajaxObj.status < 400) {
                window.location = ajaxObj.responseText
            } else {
                document.getElementById("index-page").style.display = "none";
                var errorPage = document.getElementById("error-page");
                errorPage.innerHTML = ajaxObj.responseText;
                var errorCode = document.getElementById("errorCode");
                errorCode.classList.add("shake");
                setTimeout(function () {
                    errorCode.classList.remove("shake");
                }, 500);
            }
        }
    }

    function backToHome() {
        document.getElementById("error-page").innerHTML = "";
        document.getElementById("index-page").style.display = "block";
    }
</script>
</body>
</html>